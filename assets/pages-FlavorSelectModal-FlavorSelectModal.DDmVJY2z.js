import{A as a,C as l,a as t,b as e,H as o,h as s,i as u,o as c,g as r,k as n,t as d,l as i,m as f,F as v,z as p,p as m,q as _,n as y}from"./index-BQ09tla7.js";import{_ as k}from"./_plugin-vue_export-helper.BCo6x5W8.js";const b=k({__name:"FlavorSelectModal",props:{show:Boolean,product:Object,allFlavors:{type:Array,default:()=>[]},initialQuantity:{type:Number,default:1},initialSelectedFlavors:{type:Array,default:()=>[]}},emits:["close","confirm"],setup(k,{emit:b}){const h=k,F=b,C=a([]),g=a(h.initialQuantity),x=a(99);l((()=>[h.show,h.product]),(([a,l])=>{a&&l&&(g.value=h.initialQuantity,C.value=[...h.initialSelectedFlavors])}),{immediate:!0});const q=a=>C.value.includes(a),w=()=>{g.value>1&&g.value--},j=()=>{g.value<x.value&&g.value++},A=()=>{h.product&&(F("confirm",{product:h.product,flavors:C.value,quantity:g.value}),S())},Q=a=>{if(!a||!a.name)return"/static/placeholder.png";return`/static/dishes/${a.name}.png`},S=()=>{F("close")};return(a,l)=>{const b=u,h=p,F=m,O=_;return k.show?(c(),t(b,{key:0,class:"flavor-modal-overlay",onClick:o(S,["self"])},{default:e((()=>[r(b,{class:"flavor-modal-content",onClick:l[0]||(l[0]=o((()=>{}),["stop"]))},{default:e((()=>[r(b,{class:"close-button",onClick:S},{default:e((()=>[n("×")])),_:1}),k.product?(c(),t(b,{key:0,class:"product-info-flavor-modal"},{default:e((()=>[r(h,{src:Q(k.product),mode:"aspectFill",class:"product-image-flavor-modal"},null,8,["src"]),r(b,{class:"product-details-flavor-modal"},{default:e((()=>[r(F,{class:"product-name-flavor-modal"},{default:e((()=>[n(d(k.product.name),1)])),_:1}),r(F,{class:"product-price-flavor-modal"},{default:e((()=>[n("¥"+d(k.product.price?parseFloat(k.product.price).toFixed(2):"0.00")+"/份",1)])),_:1})])),_:1}),r(b,{class:"quantity-control-flavor-modal"},{default:e((()=>[r(b,{class:"quantity-button-flavor-modal minus",onClick:w},{default:e((()=>[n("-")])),_:1}),r(F,{class:"quantity-text-flavor-modal"},{default:e((()=>[n(d(g.value),1)])),_:1}),r(b,{class:"quantity-button-flavor-modal plus",onClick:j},{default:e((()=>[n("+")])),_:1})])),_:1})])),_:1})):s("",!0),r(b,{class:"flavor-selection-area"},{default:e((()=>[r(b,{class:"flavor-label-row"},{default:e((()=>[r(F,{class:"flavor-label"},{default:e((()=>[n("口味")])),_:1}),r(F,{class:"flavor-count-text"},{default:e((()=>[n("(最多可选:"+d(x.value)+"份) "+d(C.value.length),1)])),_:1})])),_:1}),r(b,{class:"flavor-buttons-container"},{default:e((()=>[(c(!0),i(v,null,f(k.allFlavors,((a,l)=>(c(),t(b,{key:l,class:y(["flavor-button",{selected:q(a)}]),onClick:l=>(a=>{const l=C.value.indexOf(a);l>-1?C.value.splice(l,1):C.value.push(a)})(a)},{default:e((()=>[r(F,null,{default:e((()=>[n(d(a),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),0===k.allFlavors.length?(c(),t(b,{key:0,class:"no-flavors-placeholder"},{default:e((()=>[r(F,null,{default:e((()=>[n("暂无可选口味")])),_:1})])),_:1})):s("",!0)])),_:1})])),_:1}),r(b,{class:"confirm-button-area"},{default:e((()=>[r(O,{class:"confirm-button",onClick:A},{default:e((()=>[n(" 确认 ")])),_:1})])),_:1})])),_:1})])),_:1})):s("",!0)}}},[["__scopeId","data-v-fe741d53"]]);export{b as default};
